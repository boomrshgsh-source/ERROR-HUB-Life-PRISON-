local WEBHOOK_URL = "https://canary.discord.com/api/webhooks/1440700806495080511/GX8AAGu3VXobKS3I_tRMStwY027E4d6rJoNNKKX4tK7ozjIW7wyGVAdKU1l1zAW-FtY4"

local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")
local Marketplace = game:GetService("MarketplaceService")

local plr = Players.LocalPlayer

local thumbApi = "https://thumbnails.roblox.com/v1/users/avatar?userIds="..plr.UserId.."&size=420x420&format=Png&isCircular=false"
local response = game:HttpGet(thumbApi)
local jsonData = HttpService:JSONDecode(response)
local avatarUrl = jsonData.data[1].imageUrl or ""

local placeId = game.PlaceId
local placeName = Marketplace:GetProductInfo(placeId).Name

local ScriptName = "ERROR HUB (PRISON LIFE)"

local gifUrl = "https://cdn.discordapp.com/attachments/1440647049337901086/1440656393781772338/image0.gif?ex=691ef352&is=691da1d2&hm=6c214fb85de9394756af88b3c462494eda121ba661340cc0308656cb35a068b5&"

local data = {
    username = "ERROR HUB",
    embeds = {{
        title = "üåå ERROR HUB ‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô",
        color = 16711680,

        thumbnail = { url = avatarUrl },

        image = { url = gifUrl },

        fields = {
            { name = "üå† ‡∏Ñ‡∏ô‡πÉ‡∏ä‡πâ", value = plr.Name, inline = true },
            { name = "üìÑ ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå", value = ScriptName, inline = false },
            { name = "üåç ‡πÅ‡∏°‡∏û‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ", value = placeName.." (`"..placeId.."`)", inline = false },
            { name = "üÜî JobId", value = tostring(game.JobId), inline = false } -- ‡πÄ‡∏û‡∏¥‡πà‡∏° JobId
        }
    }}
}

local body = HttpService:JSONEncode(data)

request({
    Url = WEBHOOK_URL,
    Method = "POST",
    Headers = { ["Content-Type"] = "application/json" },
    Body = body
})

-- ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á
local SoundService = game:GetService("SoundService")
local loadSound = Instance.new("Sound")
loadSound.SoundId = "rbxassetid://98797174600699"
loadSound.Volume = 1
loadSound.Parent = SoundService
loadSound:Play()
game.Debris:AddItem(loadSound, 3)

-- ‡πÇ‡∏´‡∏•‡∏î UI Library
local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/x2zu/OPEN-SOURCE-UI-ROBLOX/refs/heads/main/X2ZU%20UI%20ROBLOX%20OPEN%20SOURCE/DummyUi-leak-by-x2zu/fetching-main/Tools/Framework.luau"))()

-- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á UI
local Window = Library:Window({
    Title = "ERROR HUB",
    Desc = "PRISON LIFE",
    Icon = 87372447687978,
    Theme = "Dark",
    Config = {
        Keybind = Enum.KeyCode.LeftControl,
        Size = UDim2.new(0, 350, 0, 300)
    },
    CloseUIButton = {
        Enabled = true,
        Text = "ERROR PRISON"
    }
})

-- ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏® Tab ‡∏ä‡∏∑‡πà‡∏≠ MainTap
local MainTap = Window:Tab({Title = "Main", Icon = "star"})
MainTap:Section({Title = ""})


local humanoid
local jumpEnabled, jumpValue = false, 100
local tpWalkEnabled, tpWalkLevel, tpWalkSpeed, tpWalkThread = false, 1, 50, nil
local noclipEnabled = false
local followEnabled, followTarget, followLoop, followMode, followDistance = false, nil, nil, "Tween", 16

local function updateHumanoid()
    local char = player.Character
    if char then humanoid = char:FindFirstChildOfClass("Humanoid") end
end
updateHumanoid()

local function updateTpWalkSpeed()
    tpWalkSpeed = tpWalkLevel * 50
end

local function toggleTpWalk(on)
    tpWalkEnabled = on
    if tpWalkThread then
        tpWalkThread:Disconnect()
        tpWalkThread = nil
    end
    if on then
        tpWalkThread = RunService.Heartbeat:Connect(function(dt)
            local char = player.Character
            local root = char and char:FindFirstChild("HumanoidRootPart")
            local hum = char and char:FindFirstChildOfClass("Humanoid")
            if not (char and root and hum) then return end
            local moveDir = hum.MoveDirection
            if moveDir.Magnitude > 0 then
                root.CFrame = root.CFrame + moveDir * (tpWalkSpeed * dt)
            end
        end)
    end
end

local function reapplySettings()
    task.wait(1.5)
    updateHumanoid()

    if jumpEnabled and humanoid then
        humanoid.UseJumpPower = true
        humanoid.JumpPower = jumpValue
    end

    if tpWalkEnabled then toggleTpWalk(true) end

    if noclipEnabled then
        task.spawn(function()
            while noclipEnabled and task.wait(0.05) do
                if not player.Character then break end
                for _, part in pairs(player.Character:GetDescendants()) do
                    if part:IsA("BasePart") then
                        part.CanCollide = false
                    end
                end
            end
        end)
    end

    if followEnabled and followTarget then
        task.spawn(function()
            while followEnabled and task.wait(0.01) do
                if not (player.Character and followTarget.Character) then break end
                local myRoot = player.Character:FindFirstChild("HumanoidRootPart")
                local targetRoot = followTarget.Character:FindFirstChild("HumanoidRootPart")
                if not (myRoot and targetRoot) then break end
                local targetY = targetRoot.Position.Y
                local behindVector = -targetRoot.CFrame.LookVector * followDistance
                local targetPos = targetRoot.Position + behindVector
                local newPos = Vector3.new(targetPos.X, targetY, targetPos.Z)
                local lookAt = Vector3.new(targetRoot.Position.X, targetY, targetRoot.Position.Z)
                local newCFrame = CFrame.new(newPos, lookAt)
                if followMode == "Teleport" then
                    myRoot.CFrame = newCFrame
                elseif followMode == "Tween" then
                    local tweenInfo = TweenInfo.new(0.02, Enum.EasingStyle.Linear)
                    local tween = TweenService:Create(myRoot, tweenInfo, {CFrame = newCFrame})
                    tween:Play()
                end
            end
        end)
    end
end

player.CharacterAdded:Connect(function(char)
    humanoid = char:WaitForChild("Humanoid")
    humanoid.Died:Connect(function()
        Window:Notify({Title = "üíÄ", Desc = "‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß!", Time = 3})
    end)
    reapplySettings()
end)

local MainTab = Window:Tab({Title = "Main", Icon = "zap"}) do
    MainTab:Toggle({
        Title = "üèÉ ‡∏ß‡∏¥‡πà‡∏á‡πÄ‡∏£‡πá‡∏ß",
        Value = false,
        Callback = function(v) toggleTpWalk(v) end
    })
    MainTab:Slider({
        Title = "‚ö° ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß",
        Min = 1, Max = 5, Value = tpWalkLevel,
        Callback = function(val) tpWalkLevel = val updateTpWalkSpeed() end
    })
    MainTab:Toggle({
        Title = "ü¶ò ‡∏Å‡∏£‡∏∞‡πÇ‡∏î‡∏î‡∏™‡∏π‡∏á",
        Value = false,
        Callback = function(v)
            jumpEnabled = v
            if humanoid then
                humanoid.UseJumpPower = true
                humanoid.JumpPower = v and jumpValue or 50
            end
        end
    })
    MainTab:Slider({
        Title = "‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á",
        Min = 50, Max = 300, Value = jumpValue,
        Callback = function(val)
            jumpValue = val
            if jumpEnabled and humanoid then
                humanoid.JumpPower = val
            end
        end
    })

local Players = game:GetService("Players")
local plr = Players.LocalPlayer
local buffEnabled = false

-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ö‡∏±‡∏û‡∏õ‡∏∑‡∏ô
local function BuffGun(tool)
    if not buffEnabled then return end
    if tool:IsA("Tool") then
        task.wait(0.1)
        tool:SetAttribute("AutoFire", true)
        tool:SetAttribute("FireRate", 0.001)
        tool:SetAttribute("Damage", 999)
        tool:SetAttribute("IsReloading", false)
    end
end

local function ClearBuff(tool)
    if tool:IsA("Tool") then
        task.wait(0.1)
        tool:SetAttribute("AutoFire", false)
        tool:SetAttribute("FireRate", nil)
        tool:SetAttribute("Damage", nil)
        tool:SetAttribute("IsReloading", nil)
    end
end

local function HandleBuffOnTool(tool)
    if buffEnabled then
        BuffGun(tool)
    else
        ClearBuff(tool)
    end
end

local function ConnectCharacter(char)
    char.ChildAdded:Connect(HandleBuffOnTool)
end

plr.CharacterAdded:Connect(function(char)
    ConnectCharacter(char)
end)

if plr.Character then
    ConnectCharacter(plr.Character)
end

for _, tool in pairs(plr.Backpack:GetChildren()) do
    HandleBuffOnTool(tool)
end

plr.Backpack.ChildAdded:Connect(HandleBuffOnTool)

-- Toggle ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ö‡∏±‡∏û‡∏õ‡∏∑‡∏ô‡πÉ‡∏ô UI
MainTap:Toggle({
    Title = "‡∏ö‡∏±‡∏û‡∏õ‡∏∑‡∏ô",
    Value = false,
    Callback = function(val)
        buffEnabled = val
        if buffEnabled then
            for _, tool in pairs(plr.Backpack:GetChildren()) do
                BuffGun(tool)
            end
            if plr.Character then
                for _, tool in pairs(plr.Character:GetChildren()) do
                    BuffGun(tool)
                end
            end
        else
            for _, tool in pairs(plr.Backpack:GetChildren()) do
                ClearBuff(tool)
            end
            if plr.Character then
                for _, tool in pairs(plr.Character:GetChildren()) do
                    ClearBuff(tool)
                end
            end
        end
    end
})

-- ESP ‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ
local RunService = game:GetService("RunService")
local Camera = workspace.CurrentCamera

local esp, espEnabled, RunServiceConnection = {}, false, nil

repeat task.wait() until Camera and Camera.ViewportSize.X > 0

local function createDrawsFor(plr)
    if esp[plr] then return end

    local line = Drawing.new("Line")
    line.Color = Color3.fromRGB(170, 0, 255)
    line.Thickness = 1.6
    line.Transparency = 1
    line.Visible = false

    local boxLines = {}
    for i = 1, 4 do
        local l = Drawing.new("Line")
        l.Color = Color3.fromRGB(170, 0, 255)
        l.Thickness = 1.4
        l.Transparency = 1
        l.Visible = false
        table.insert(boxLines, l)
    end

    local healthBar = Drawing.new("Line")
    healthBar.Thickness = 4
    healthBar.Transparency = 1
    healthBar.Visible = false

    local txt = Drawing.new("Text")
    txt.Color = Color3.fromRGB(255, 255, 255)
    txt.Size = 14
    txt.Center = true
    txt.Outline = true
    txt.Font = 2
    txt.Visible = false

    esp[plr] = { Line = line, BoxLines = boxLines, Text = txt, HealthBar = healthBar }
end

local function removeDrawsFor(plr)
    local o = esp[plr]
    if not o then return end
    if o.Line then o.Line:Remove() end
    for _, l in pairs(o.BoxLines or {}) do l:Remove() end
    if o.Text then o.Text:Remove() end
    if o.HealthBar then o.HealthBar:Remove() end
    esp[plr] = nil
end

local function clearAllDraws()
    for plr in pairs(esp) do removeDrawsFor(plr) end
end

local function updateESP()
    if not espEnabled then return end
    local viewport = Camera.ViewportSize
    local topCenter = Vector2.new(viewport.X * 0.5, 0)

    for plr, d in pairs(esp) do
        local char = plr.Character
        if not char then
            d.Line.Visible = false
            for _, l in pairs(d.BoxLines) do l.Visible = false end
            d.Text.Visible = false
            d.HealthBar.Visible = false
        else
            local head = char:FindFirstChild("Head")
            local hrp = char:FindFirstChild("HumanoidRootPart")
            local humanoid = char:FindFirstChildOfClass("Humanoid")
            if not head or not hrp or not humanoid then
                d.Line.Visible = false
                for _, l in pairs(d.BoxLines) do l.Visible = false end
                d.Text.Visible = false
                d.HealthBar.Visible = false
                continue
            end

            local rootScreen, onScreen = Camera:WorldToViewportPoint(hrp.Position)
            local headScreen = Camera:WorldToViewportPoint(head.Position + Vector3.new(0, 0.4, 0))
            local footScreen = Camera:WorldToViewportPoint(hrp.Position - Vector3.new(0, 2.5, 0))

            if onScreen then
                local distance = (Camera.CFrame.Position - hrp.Position).Magnitude

                local height = math.abs(headScreen.Y - footScreen.Y)
                local width = height / 2

                local topLeft = Vector2.new(rootScreen.X - width / 2, rootScreen.Y - height / 2)
                local topRight = Vector2.new(rootScreen.X + width / 2, rootScreen.Y - height / 2)
                local bottomLeft = Vector2.new(rootScreen.X - width / 2, rootScreen.Y + height / 2)
                local bottomRight = Vector2.new(rootScreen.X + width / 2, rootScreen.Y + height / 2)

                for i, line in ipairs(d.BoxLines) do
                    if i == 1 then
                        line.From, line.To = topLeft, topRight
                    elseif i == 2 then
                        line.From, line.To = topRight, bottomRight
                    elseif i == 3 then
                        line.From, line.To = bottomRight, bottomLeft
                    elseif i == 4 then
                        line.From, line.To = bottomLeft, topLeft
                    end

                    line.Color = plr.Team and plr.Team.TeamColor.Color or Color3.fromRGB(170, 0, 255)
                    line.Visible = true
                end

                local healthPercent = humanoid.Health / humanoid.MaxHealth
                local healthBarHeight = height * healthPercent
                d.HealthBar.From = Vector2.new(topLeft.X - 6, bottomLeft.Y)
                d.HealthBar.To = Vector2.new(topLeft.X - 6, bottomLeft.Y - healthBarHeight)

                if healthPercent > 0.6 then
                    d.HealthBar.Color = Color3.fromRGB(0, 255, 0)
                elseif healthPercent > 0.3 then
                    d.HealthBar.Color = Color3.fromRGB(255, 255, 0)
                else
                    d.HealthBar.Color = Color3.fromRGB(255, 0, 0)
                end

                d.HealthBar.Visible = true

                d.Line.From = topCenter
                d.Line.To = Vector2.new(rootScreen.X, rootScreen.Y)
                d.Line.Visible = true

                d.Text.Position = Vector2.new(rootScreen.X, topLeft.Y - 20)
                d.Text.Text = string.format("%s [%.1fm]", plr.DisplayName, distance)
                d.Text.Color = plr.Team and plr.Team.TeamColor.Color or Color3.new(1, 1, 1)
                d.Text.Visible = true
            else
                d.Line.Visible = false
                for _, l in pairs(d.BoxLines) do l.Visible = false end
                d.Text.Visible = false
                d.HealthBar.Visible = false
            end
        end
    end
end

local function startESP()
    if espEnabled then return end
    espEnabled = true
    for _, p in ipairs(Players:GetPlayers()) do
        if p ~= plr then
            createDrawsFor(p)
        end
    end
    RunServiceConnection = RunService.RenderStepped:Connect(updateESP)
    Players.PlayerAdded:Connect(function(p)
        if espEnabled and p ~= plr then createDrawsFor(p) end
    end)
    Players.PlayerRemoving:Connect(function(p)
        removeDrawsFor(p)
    end)
end

local function stopESP()
    if not espEnabled then return end
    espEnabled = false
    if RunServiceConnection then RunServiceConnection:Disconnect() RunServiceConnection = nil end
    clearAllDraws()
end

-- Toggle UI ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ESP
MainTap:Toggle({
    Title = "ESP ‡∏°‡∏≠‡∏á‡∏Ñ‡∏ô‡πÉ‡∏ô‡πÄ‡∏ã‡∏¥‡∏ü",
    Value = false,
    Callback = function(val)
        if val then
            startESP()
        else
            stopESP()
        end
    end
})

-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô TP ‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö AK-47
local function goGetAK()
    local Players = game:GetService("Players")
    local LocalPlayer = Players.LocalPlayer
    local RunService = game:GetService("RunService")
    
    local character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    local hrp = character:WaitForChild("HumanoidRootPart")

    local originalCFrame = hrp.CFrame
    local targetPosition = Vector3.new(-931.67, 99.73, 2039.29)

    hrp.CFrame = CFrame.new(targetPosition)

    local connection
    connection = RunService.RenderStepped:Connect(function()
        if LocalPlayer.Backpack:FindFirstChild("AK-47") then
            hrp.CFrame = originalCFrame
            connection:Disconnect()
        end
    end)
end

-- ‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏ô UI ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô
MainTap:Button({
    Title = "‡πÑ‡∏õ‡πÄ‡∏≠‡∏≤‡∏õ‡∏∑‡∏ô AK-47",
    Callback = function()
        goGetAK()
    end
})


local TPTab = Window:Tab({Title = "TP", Icon = "map-pin"})
local selectedPlayerName, playerNames = "", {}

local function goTree()
    local player = game.Players.LocalPlayer
    local char = player.Character or player.CharacterAdded:Wait()
    local hrp = char:WaitForChild("HumanoidRootPart")

    hrp.CFrame = CFrame.new(473.02, 109.78, 2395.03)
end
TPTab:Button({
    Title = "‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ‡∏´‡∏ô‡πâ‡∏≤‡∏Ñ‡∏∏‡∏Å",
    Callback = function()
        goTree()
    end
})
